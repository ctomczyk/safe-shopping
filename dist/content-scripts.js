!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";"undefined"==typeof globalThis&&(Object.defineProperty(Object.prototype,"__magic__",{configurable:!0,get:function(){return this}}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__);const e={NAME:"safe-shopping"};class t{static createCSS(e,t=document.head,o,n){if(null===e)throw new Error("[CommonUtility.createCSS] passed content is not a string. Is type "+typeof e);const a=document.createElement("style");return"string"==typeof o&&(a.id=o),"string"==typeof n&&n.length>0&&a.setAttribute("media",n),"object"==typeof a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e)),t.appendChild(a),a}static isHostMethod(e,o){if(!e)return!1;const n=typeof e[o];return t.reUnknown.test(n)||t.reMethod.test(n)&&Boolean(e)||!1}static isRealObjectProperty(e,t){return Boolean("object"==typeof e[t]&&e[t])}static isHtmlElement(e){if(null===e)return!1;try{return e instanceof Element||e instanceof Document}catch(t){return"object"==typeof e&&e.nodeType===Node.ELEMENT_NODE&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}}static getStyle(e,o,n){return!1===t.isHtmlElement(e)?null:t.isHostMethod(window,"getComputedStyle")?window.getComputedStyle(e,n||null).getPropertyValue(o):t.isRealObjectProperty(document,"defaultView")?document&&document.defaultView&&document.defaultView.getComputedStyle(e,n||null).getPropertyValue(o):null}static getLanguageForTranslations(){let e="en";return"string"==typeof document.documentElement.lang&&"cs"===document.documentElement.lang.split("-")[0]?e="cs":"string"==typeof window.navigator.language&&window.navigator.language.length>0?e=window.navigator.language:Array.isArray(window.navigator.languages)&&window.navigator.languages.length>0&&(e=window.navigator.languages[0]),e.split("-")[0]}static getHighestZindex(){const e=document.getElementsByTagName("*"),o=e.length,n=[];let a;for(let i=0;i<o;i+=1)a=t.getStyle(e[i],"z-index"),null!==a&&"auto"!==a&&n.push(Number(a));return 0===n.length?0:Math.max(...n)}static async getPageResponseHeaders(e){const t=await window.fetch(document.location.href,{body:null,method:"HEAD"}),o=[];return t.headers.forEach(((e,t)=>{o.push({[t.toLowerCase()]:e})})),"string"==typeof e?o.filter((t=>"string"==typeof t[e])):o}static async fetchData(){const o=await t.getPageResponseHeaders(),n=o.find((e=>"string"==typeof e["last-modified"])),a=o.find((e=>"string"==typeof e.date));let i=0;n?i=new Date(n["last-modified"]).getTime():a&&(i=new Date(a.date).getTime());const r=window.localStorage.getItem(e.NAME);let s=null;r&&(s=JSON.parse(r)),null!==s&&void 0!==s.lastModified||window.localStorage.clear();let l="";if(r&&"number"==typeof(null==s?void 0:s.lastModified)&&i>(null==s?void 0:s.lastModified))l=s.content;else try{const t="https://www.coi.cz/pro-spotrebitele/rizikove-e-shopy/",o=await window.fetch(t);l=await o.text();const n=JSON.stringify({content:l,lastModified:i});window.localStorage.setItem(e.NAME,n)}catch(e){}return l}}t.reMethod=/^(function|object)$/,t.reUnknown=/^unknown$/;const o={cs:{actionClose:"Zavři",message:"Přečtěte si více o bezpečném nakupování",openNewUrl:"Otevře externí web v novém okně"},en:{actionClose:"Close",message:"Read more about safe shopping",openNewUrl:"Opens an external site in a new window"}};(new class{constructor(){this.elementMessageId="safeShoppingMessage"}initialiseLayout(){if("string"==typeof window.sessionStorage.getItem("safeShopping"))return;const e=document.createElement("div");if(document.getElementById(this.elementMessageId))return;e.className="safe-alert-message",e.id=this.elementMessageId,e.setAttribute("role","alert"),e.setAttribute("tabindex","-1"),e.style.zIndex=String(t.getHighestZindex()+1);const n=t.getLanguageForTranslations(),a=void 0===o[n]?o.en:o[n];e.setAttribute("lang",n),e.innerHTML=`<div><a href="https://www.coi.cz/pro-spotrebitele/rizikove-e-shopy/#:~:text=${location.hostname}" target="_blank" rel="noopener" aria-describedby="opens-an-external-site-in-new-window">${a.message}</a><button type="button">${a.actionClose}</button></div>\n    <span hidden>\n      <span id="opens-an-external-site-in-new-window">${a.openNewUrl}</span>\n    </span>`,document.body.appendChild(e);const i="safe_shopping_styles";try{t.createCSS(":root .safe-alert-message{background:rgba(0,0,0,.7);color:#fff;display:flex;justify-content:center;left:0;padding:1rem 0;position:fixed;top:0;width:100%;z-index:1000}:root .safe-alert-message:focus{outline:1px dotted gray;outline-offset:-2px}:root .safe-alert-message div{align-items:center;animation-delay:initial;animation-duration:1s;animation-fill-mode:forwards;animation-iteration-count:1;animation-name:fade-in;display:flex;justify-content:center;margin-top:-7rem;max-height:4rem;position:relative;top:0;width:auto}@supports(height: fit-content){:root .safe-alert-message div{height:fit-content}}:root .safe-alert-message div a{align-items:center;background:#bf2726;border-radius:5px;box-shadow:0 0 18px -1px rgba(0,0,0,.32);color:#fff;display:inline-flex;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,sans-serif;font-size:16px;font-weight:normal;justify-content:center;padding:.5rem 2rem;text-decoration-skip-ink:auto;text-underline-position:below;transition:margin-top .3s ease-in-out}:root .safe-alert-message div a:link,:root .safe-alert-message div a:visited{background:#bf2726;color:#fff;text-decoration:none}:root .safe-alert-message div a:focus,:root .safe-alert-message div a:hover{background:#941e1e;color:#fff;outline:2px dotted gray;outline-offset:2px;text-decoration:underline}:root .safe-alert-message div a:active{background:#6a1615;color:#fff;text-decoration:none}:root .safe-alert-message div a::after{background-image:url(\"data:image/svg+xml;charset=utf8, %3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3E%3Cpath fill='%23fff' d='M2.469 0l-2.469 3h2v5h1v-5h2l-2.531-3z' transform='translate(1)'%3E%3C/path%3E%3C/svg%3E\");content:\"\";display:inline-flex;height:1rem;margin-left:.25rem;margin-top:-0.25rem;position:relative;transform:rotateY(0deg) rotate(45deg);width:1rem}:root .safe-alert-message div button{background:#006fe6;border:0;color:#fff;font-size:16px;margin-left:2rem;padding:.5rem 1.5rem}:root .safe-alert-message div button:focus,:root .safe-alert-message div button:hover{outline:2px dotted gray;outline-offset:2px}@keyframes fade-in{from{margin-top:-7rem;opacity:0}to{margin-top:0;opacity:1}}.visually-hidden{border:0 !important;clip:rect(0, 0, 0, 0) !important;height:1px !important;margin:-1px !important;overflow:hidden !important;padding:0 !important;position:absolute !important;white-space:nowrap !important;width:1px !important}:root .safe-alert-message button{background:rgba(0,0,0,0);border:0;border-radius:revert;color:inherit;font:revert;letter-spacing:revert;line-height:normal;margin:0;min-height:revert;overflow:visible;padding:0;text-align:inherit;text-transform:revert;transition:none;width:auto}:root .safe-alert-message button{border-radius:.25rem;padding:.375rem .75rem}:root .safe-alert-message button:focus,:root .safe-alert-message button:hover{background-color:#0056b3;border-color:#0056b3}/*# sourceMappingURL=styles.bundle.css.map */\n",document.head,i)}catch(e){}const r=e.querySelector("button"),s=()=>{var t;null==r||r.removeEventListener("click",s),document.body.removeEventListener("click",l),document.body.removeEventListener("keydown",l),e.remove(),null===(t=document.querySelector(`#${i}`))||void 0===t||t.remove()},l=e=>{if("keydown"===e.type){if("string"==typeof e.key&&"Escape"!==e.key||"string"==typeof e.code&&"Escape"!==e.code)return;return s(),void e.preventDefault()}e.target.closest(`#${this.elementMessageId}`)||s()};null==r||r.addEventListener("click",s),document.body.addEventListener("click",l),document.body.addEventListener("keydown",l),window.sessionStorage.setItem("safeShopping","installed"),window.setTimeout((()=>{null==e||e.focus()}),500)}async evaluateSiteHostname(){const e=await t.getPageResponseHeaders(),o=e.find((e=>"string"==typeof e["last-modified"])),n=e.find((e=>"string"==typeof e.date));o?(console.log("lastModified",new Date(o["last-modified"]).getTime()),t.fetchData()):n&&t.fetchData();let a="";try{a=await t.fetchData()}catch(e){i=e,console.debug("[SafeShopping]",i)}var i;(e=>{const t=(new DOMParser).parseFromString(e,"text/html");!1!==Array.from(t.querySelectorAll(".information-row .entry-content .list_titles span")).map((e=>e.textContent?e.textContent:"")).filter((e=>e.length>0)).some((e=>e.includes(location.hostname)||location.hostname.includes(e)))&&window.setTimeout((()=>{this.initialiseLayout()}),3500)})(a)}}).evaluateSiteHostname()}));
